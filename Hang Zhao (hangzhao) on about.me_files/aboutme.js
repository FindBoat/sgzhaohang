window.AboutMe={_name:"AboutMe",error:function(b,a){a=a||{};a.status="error";return AboutMe.alert(b,a)},alert:function(b,a){return AboutMe.notification.modal(b,a)},confirm:function(h,e,g){if(typeof e!="function"){throw"Invalid handler function."}g=$.extend({title:"Confirmation",close:function(){$("body").unbind("keydown.confirm-true").unbind("keydown.confirm-false")},closeOnEscape:false},g);var c=AboutMe.notification.modal(h,g);var f=g.buttons||{Yes:function(){$(c).dialog("close");e(true)},No:function(){$(c).dialog("close");e(false)}};var j=c.closest(".ui-dialog").find(".ui-dialog-buttonset").empty().addClass("buttons");for(var a in f){var d=$('<span class="button"><span class="button-content">'+a+"</span></span>");d.click(f[a]);j.append(d)}j.find("span.button").eq(0).addClass("button-default");$("body").bind("keydown.confirm-true",function(b){handleReturnKey(b,function(){$(c).dialog("close");e(true)})});$("body").bind("keydown.confirm-false",function(b){handleEscapeKey(b,function(){$(c).dialog("close");e(false)})});return c},bubble:function(b,a){return AboutMe.notification.bubble.init(b,a)},banner:function(b,a){return AboutMe.notification.banner(b,a)},inlinebanner:function(b,a){return AboutMe.notification.inlinebanner(b,a)},timestamp:function(){debug("- "+(new Date()).getTime()+" -")}};AboutMe.init=function(){AboutMe.menu.init();AboutMe.FindPeople.init();$(".expandable.expandable-trigger, .expandable .expandable-trigger, .expandable .expandable-toggle").click(function(){var a=$(this).closest(".expandable");if(a.find(".expanded-content-animate").length){if(a.hasClass("expanded")){a.find(".expanded-content-animate").slideToggle("fast",function(){a.toggleClass("expanded")})}else{a.find(".expanded-content-animate").slideToggle("fast");a.toggleClass("expanded")}}else{a.toggleClass("expanded")}}).filter("a").click(function(){return false});if(!AboutMe.g){AboutMe.g={}}AboutMe.g.now=new Date();AboutMe.g.timezone=-AboutMe.g.now.getTimezoneOffset()*60000;$(window).scroll(function(){if(document.body.scrollTop>AboutMe.g.NAV_HEIGHT){$("body").addClass("scrolled")}else{$("body").removeClass("scrolled")}})};$(document).ready(AboutMe.init);AboutMe.htmlEncode=function(a){return $("<div/>").text(a).html()};AboutMe.htmlDecode=function(a){return $("<div/>").html(a).text()};AboutMe.menu={init:function(){$("body").on("click.menutoggle",".menu .menu-toggle",AboutMe.menu.toggle);$("body").on("click.menuhide",AboutMe.menu.hide);$(".menu li.separator, .menu li.disabled a").click(function(a){a.preventDefault();return false})},toggle:function(){var b=$(this).closest("li");if(b.hasClass("disabled")){return false}var c=$(this).closest(".menu");var a=c.find(".menu-content");$(".menu").not(c).removeClass("menu-active");$(".menu .menu-content").not(a).hide();c.toggleClass("menu-active");if($.browser.msie&&parseInt($.browser.version)<=8){if(c.closest("#profile_box .actions").length){$("#profile_box .actions").toggleClass("menu-overflow-fix")}}a.stop(false,true).toggleFade({speedIn:150,speedOut:250});if($(this).hasClass("menu-toggle")){return false}},hide:function(){if($(this).closest(".menu-toggle").length){return}$(".menu.menu-active").removeClass("menu-active").find(".menu-content").stop(false,true).fadeOut(250);if($.browser.msie&&parseInt($.browser.version)<=8){$("#profile_box .actions").removeClass("menu-overflow-fix")}}};AboutMe.FindPeople={init:function(){$("#header li.peoplemenu li.findform input").click(function(a){a.preventDefault();return false});$("#header li.peoplemenu .fauxfield").bind("click.focusfield",function(a){$.doTimeout(10,function(){$("#header li.findform input").val("").focus()})});$("#header li.peoplemenu li.findform form").submit(AboutMe.FindPeople.find)},find:function(){var e=$(this).find("input.text").val();if(e==""){return}var b="/search/#!/name/";var f=e.split(" ");if(f.length>2){var a=f.pop();var d=f.join("+");var c=d+"/"+a}else{var c=f.join("/")}document.location=b+c}};AboutMe.ajax={_name:"AboutMe.ajax",_queue:[],_error:function(c,b,d,f,e,a){if(!a){AboutMe.error("AJAX api call error: "+c+": "+f+": "+JSON.stringify(d))}else{a(d,b,c,f,e)}},_begin:function(b,a){if(!a.begin){}else{a.begin(b,a)}},_complete:function(b,a,d,c){if(!c){}else{c(a,b,d)}},_success:function(b,a,c,e,d){if(!d){AboutMe.alert("AJAX callback successful: "+b+": "+e+": "+JSON.stringify(c))}else{d(c,a,b,e)}},_mangle:function(d){var c={};c.data={};c.options={};c.callback=null;if(d.length<1||typeof d[0]!="string"){throw"Invalid api_call."}c.api_call=d[0];var a=["data","options","options"];var b=0;for(i=1;i<4;i++){if(!d[i]){continue}if($.isFunction(d[i])){c.callback=d[i];continue}c[a[b]]=d[i];b++}if(!c.callback&&c.options.success&&$.isFunction(c.options.success)){c.callback=c.options.success}return c},_checkQueue:function(){if(this._queue.length){var a=this._queue.shift();a.call()}else{this.queued=false}},get:function(b,c,a,e){var d=this._mangle([b,c,a,e]);d.options.type="GET";this.request(d.api_call,d.data,d.options,d.callback)},post:function(b,c,a,e){var d=this._mangle([b,c,a,e]);d.options.type="POST";this.request(d.api_call,d.data,d.options,d.callback)},load:function(a,c,b,d){handler=function(e,g,f){if(g=="error"){AboutMe.banner("There was an error. Please try again later.",{status:"error"})}if(d){d(e,g,f)}};$.extend(b,{call:a});$.ajaxSetup({cache:false});$(c).load("/ajax",b,handler)},request:function(b,c,p,n){var d=this;var g=$.isFunction(n)?n:null;var o=$.isFunction(p.error)?p.error:null;var h=$.isFunction(p.complete)?p.complete:null;if(p.data){$.extend(c,p.data)}$.each(["complete","data","error","success"],function(r,q){delete p[q]});var k={};var f=["async","beforeSend","cache","complete","contentType","context","data","dataFilter","dataType","error","global","ifModified","jsonp","jsonpCallback","password","processData","scriptCharset","success","timeout","traditional","type","url","username","xhr"];$.each(p,function(q,r){if($.inArray(q,f)!=-1){k[q]=r;delete p[q]}});var e=function(q,t,s){if(q.error){var r=parseInt(q.error);if(r){q.error=r}else{q.msg=q.error;q.error=1}}else{q.error=0;if(!q.msg){q.msg=""}}if(!q.success||q.error!=0){d._error(b,p,q,t,"BackendError",o)}else{d._success(b,p,q,t,g)}};var a=function(s,t,r){var q={success:false,error:-1,msg:"An error has occurred."};d._error(b,p,q,t,r,o)};var m=function(q,r){d._complete(b,p,r,h)};var l=$.extend({},c,{call:b});var j={cache:false,complete:m,data:l,dataType:"json",error:a,success:e,type:"POST",url:"/ajax"};$.extend(j,k);d._begin(b,p);$.ajax(j)},debug:function(a,b){if(a.error&&a.msg){var c="";if(b){c+=b+": "}c+=a.error+": ";c+=a.msg;debug(c)}else{debug("AboutMe.ajax.debug failed: output glob is missing needed properties.");debug(a)}}};AboutMe.Saver=function(a){this.data={};this.throttled=null;this.saving=false;this.cache={_id:"cache data"};this.attempts=0;this.options={name:"Saver",delay:5000,call:"save",maxattempts:10,quietproperties:[]};if(a){$.extend(this.options,a)}};AboutMe.Saver.prototype={save:function(b,d){var e=this;var c=e._mangle(b,d);$.extend(e.data,c);e.data=e._checkCache(e.data);if($.isEmptyObject(e.data)){$(window).unbind("beforeunload."+e.options.name);return}if(e.disabled){return}clearTimeout(e.throttled);e.throttled=setTimeout(function(){e._submit()},e.options.delay);var a=$.extend({},e.data);$.each(e.options.quietproperties,function(f){delete a[e.options.quietproperties[f]]});if(!$.isEmptyObject(a)){debug("data not empty");if(e.banner){e.banner.remove()}$(window).unbind("beforeunload."+e.options.name);$(window).bind("beforeunload."+e.options.name,function(){e.disabled=true;e.unsavedchanges=true;clearTimeout(e.throttled);var f=function(){debug("bound");$("body").bind("mousemove."+e.options.name,function(){$("body").unbind("mousemove."+e.options.name);debug("mouse moved");e.disabled=false;e.save()})};setTimeout(f,100);return"You have unsaved changes."})}},saveNow:function(){var a=this;clearTimeout(a.throttled);a._submit()},updatecache:function(a,c){var d=this;var b=d._mangle(a,c);$.extend(d.cache,b)},_mangle:function(a,c){var b=null;if(typeof a=="string"&&typeof c!="undefined"){b={};b[a]=c}if(typeof a=="object"&&typeof c=="undefined"){b=a}if(typeof a=="undefined"&&typeof c=="undefined"){b={}}if(!b){debug(a);debug(c);throw"Invalid save data."}return b},_checkCache:function(c){var d={};for(var a in c){if(c.hasOwnProperty(a)){var b=true;if(this.cache[a]!=null){if(JSON.stringify(c[a])==JSON.stringify(this.cache[a])){b=false}}if(b){d[a]=c[a]}}}return d},_submit:function(b){var c=this;if(c.saving||c.disabled){return}c.data=c._checkCache(c.data);if($.isEmptyObject(c.data)){$(window).unbind("beforeunload."+c.options.name);return}var a=$.extend({},c.data);c.data={};b=b||{};b=$.extend({success:function(d,e,f,g){c._saveSuccess(a,d,e,f,g)},error:function(d,e,f,g){c._saveError(a,d,e,f,g)}},b);if(typeof c.options.beforeSave=="function"){c.options.beforeSave()}c.saving=true;console.time("save time");AboutMe.ajax.post(c.options.call,a,b);if(typeof c.options.afterSave=="function"){c.options.afterSave()}},_saveComplete:function(b,a,c,d,f){var e=this;e.saving=false;$(window).unbind("beforeunload."+e.options.name);$("body").unbind("mousemove."+e.options.name);console.timeEnd("save time");e.attempts=0;e.unsavedchanges=false;e.save()},_saveSuccess:function(b,a,c,d,f){var e=this;delete b.call;e.updatecache(b);e._list(b);if(typeof e.options.success=="function"){e.options.success.apply(e,[b,a,c,d,f])}else{debug("Save succeeded.")}e._saveComplete(b,a,c,d,f)},_saveError:function(b,a,c,d,f){var e=this;if(e.options.maxattempts){if(e.attempts<e.options.maxattempts){e.attempts++;debug("Save failed. Attempt#"+e.attempts);e.save(b)}else{e.attempts=0;AboutMe.error("There was an error saving your changes. Please try again. You may need to reload the page.")}}if(typeof e.options.error=="function"){e.options.error.apply(e,[b,a,c,d,f])}else{debug("Save failed.");debug(b)}e._saveComplete(b,a,c,d,f)},_list:function(b){for(var a in b){if(b.hasOwnProperty(a)){debug(a+": "+b[a])}}}};AboutMe.TokenBox=function(a,b){this.node=$(a);this.o=$.extend({debug:false,allowPaste:true,trimtext:true,allowemptytext:false,ignoreinvalidinput:false,sortable:true,tokenize_keycodes:[9,13,32,188]},b);this.init()};AboutMe.TokenBox.prototype={init:function(){var a=this;if(a.o.limit){a.o.limitmessage=a.o.limitmessage||"Only "+a.o.limit+" items allowed.";if(typeof a.o.limitcallback=="undefined"){a.o.limitcallback=function(){var c=this;if(c.limited){if(!c.alarum){c.alarum=$('<label class="alarum">'+c.o.limitmessage+"</label>");c.node.after(c.alarum)}}else{if(c.alarum){c.alarum.remove();c.alarum=null}}}}}a.input=$('<input type="text" class="tokeninput" autocomplete="off" spellcheck="false" />');if(a.o.maxlength){a.input.attr("maxlength",a.o.maxlength)}a.input.keydown(a.handleKeydown);a.input.keyup(a.handleKeyup);a.input.bind("paste",a.handlePaste);a.input.bind("keyup keydown focus update change",function(){$.doTimeout("scrolltoinput",10,function(){})});a.input.attr("tabindex",a.node.attr("tabindex"));a.node.removeAttr("tabindex");a.node.addClass("tokenbox").append(a.input).click(function(){a.deselectItem();a.input.focus()});a.input.blur(function(){});a.input.autoGrowInput();if(a.o.id){var b=(a.o.debug)?"text":"hidden";a.partner=$('<input type="'+b+'" id="'+a.o.id+'" name="'+a.o.id+'" size="100" />');a.node.after(a.partner)}if(a.o.sortable){$(a.node).sortable({containment:"parent",tolerance:"pointer",items:".token",cancel:"input.tokeninput, .remove",scroll:false,start:function(c,d){a.node.css("overflow","hidden");a.node.find(".selected").removeClass("selected");d.item.addClass("selected shadow");d.placeholder.html("&nbsp;").css({border:"1px dotted #666",height:"auto",opacity:0.2}).vshow();a.input.blur()},stop:function(c,d){a.node.css("overflow","auto");d.item.removeClass("selected shadow");a.changed();a.input.focus()}})}if(a.o.items){a.insertTokens(a.o.items)}if(a.o.init){a.o.init.call(a)}},handlePaste:function(b){var a=$(this).closest(".tokenbox").tokenbox();if(!a.o.allowPaste){return false}if(a.limited){return false}if(a.o.tokenizeOnPaste&&a.o.tokenize){$.doTimeout("tokenize",100,function(){a.o.tokenize.call(a)})}},handleKeydown:function(d){var c=$(this).closest(".tokenbox").tokenbox();d=getEvent(d);var a=getKeyCode(d);if(d.metaKey||d.ctrlKey){return}if(c.input.val()==""&&$.inArray(a,[8,9,13,37,38,39,40])>=0){switch(a){case 8:c.deleteSelectedItem();d.preventDefault();break;case 9:case 13:return;break;case 37:case 38:c.selectPreviousItem();d.preventDefault();break;case 39:case 40:c.selectNextItem();break}}else{if(c.limited){return false}c.deselectItem();c.input.focus();c.scrollToItem(c.input)}if(c.o.keydown){c.o.keydown.apply(c,[d])}if($.inArray(a,c.o.tokenize_keycodes)>-1){if(a==188&&d.shiftKey){return true}if(c.o.tokenize){c.o.tokenize.call(c)}else{var b=c.newToken(c.input.val());if(!b){if(c.o.ignoreinvalidinput){c.input.val("").removeClass("error").focus()}else{c.input.addClass("error").focus()}}else{c.input.val("").removeClass("error").focus()}}if(a!=9&&a!=32){c.input.focus();d.preventDefault()}}},handleKeyup:function(b){var a=$(this).closest(".tokenbox").tokenbox();if(a.input.val()==""){a.input.removeClass("error")}if(a.o.keyup){a.o.keyup.apply(a,[b])}},scrollToInput:function(){var a=$(this).closest(".tokenbox").tokenbox();a.node.scrollTop(a.node[0].scrollHeight)},scrollToItem:function(a){a=$(a);var b=a.closest(".tokenbox").tokenbox();itemtop=a.offset().top-b.node.offset().top},deleteSelectedItem:function(){var b=this;var a=b.node.find(".token.selected");if(a.length){a.remove();b.changed();b.input.focus()}else{b.selectLastItem()}},selectPreviousItem:function(){var c=this;var a=c.node.find(".token.selected");if(a.length){var b=a.prev(".token");if(b.length){a.removeClass("selected");b.addClass("selected");c.scrollToItem(b)}}else{c.selectLastItem()}},selectNextItem:function(){var c=this;var b=c.node.find(".token.selected");if(b.length){var a=b.next(".token");b.removeClass("selected");if(a.length){a.addClass("selected");c.scrollToItem(a)}}},selectLastItem:function(){var b=this;var a=b.node.find(".token").last();if(a.length){a.addClass("selected");b.scrollToItem(a)}},deselectItem:function(){var a=this;a.node.find(".selected").removeClass("selected")},checkLimit:function(){var a=this;if(a.o.limit&&a.node.find(".token").length>=a.o.limit){debug("Reached token limit: "+a.o.limit);a.limited=true}else{a.limited=false}if(a.o.limitcallback){a.o.limitcallback.call(a)}},newToken:function(d,c){var b=this;if(b.o.trimtext){d=$.trim(d)}if(b.o.minlength&&d.length<b.o.minlength){return false}if(b.o.validateToken){d=b.o.validateToken.apply(b,[d])}if(!b.o.allowemptytext){if(d===""){d=false}}if(d===false){return false}if(!b.limited){c=$.extend({removable:true},c);var a=b.tokenMarkup(d,c);if(c.removable){a.addClass("removable").prepend('<div class="remove">&nbsp;</div>').removable({afterRemove:function(){b.changed()}});a.click(function(f){b.node.find(".token.selected").removeClass("selected");$(this).addClass("selected");b.input.focus();return false})}b.input.before(a);b.changed();return(a)}},tokenMarkup:function(c,b){var a=$('<div class="token"><span class="token-content">'+AboutMe.htmlEncode(c)+"</span></div>");a.data("token",c);return a},insertTokens:function(a,b){for(i in a){this.newToken(a[i],b)}},getTokens:function(){var a=[];this.node.find(".token").each(function(){var b=$(this).data("token");a.push(b)});return a},changed:function(){var b=this;if(b.partner){var a=b.getTokens();b.partner.val(JSON.stringify(a))}b.checkLimit();if(b.o.onchange){b.o.onchange.call(b)}},reset:function(){var a=this;a.node.find(".token").remove();a.changed()}};(function(a){a.fn.tokenbox=function(b){if(this.data("tokenbox")){return this.data("tokenbox")}if(a(this).find("input.tokeninput").length){return false}return this.each(function(){a(this).data("tokenbox",new AboutMe.TokenBox(this,b))})}})(jQuery);AboutMe.TokenBox.configs={tags:{tokenize_keycodes:[9,13,188],allowPaste:false,minlength:2,maxlength:30,id:"tags",limit:10,limitmessage:"You can enter up to 10 tags.",limitcallback:function(){},init:function(){},validateToken:function(d){var c=this;if(d.match(/[<>*?+\/\\\[\]\{\}]/g)){return false}d=d.replace(/\s+/g," ");var b=c.getTokens();for(var a in b){b[a]=b[a].toLowerCase()}if($.inArray(d.toLowerCase(),b)==-1){return d}else{return false}}}};AboutMe.ProgressBar=function(a,b){if(typeof a=="string"){this.node=$(this.template);this.node.find(".progress-message span").html(a)}else{this.node=$(a);if(!this.node.find(".progress-message").length){this.node.wrap('<div class="progress-message"></div>')}this.node=this.node.closest(".progress-message");if(!this.node.find(".progress-banner").length){this.node.wrap('<div class="progress-banner"></div>')}this.node=this.node.closest(".progress-banner");if(!this.node.find(".progressbar").length){this.node.append('<div class="progressbar"></div>')}debug(this.node)}this.o=$.extend({where:"body",maxwidth:600},b);if(this.o.where){this.node.appendTo(this.o.where)}this.init();return this.node};AboutMe.ProgressBar.prototype={template:'<div class="progress-banner"><div class="progress-message"><span></span></div><div class="progressbar"></div></div>',init:function(){var a=this;a.left=0;a.interval=setInterval(function(){a.animate()},40);a.checkWidth();$.doTimeout(100,function(){a.checkWidth()})},checkWidth:function(){var b=this;b.node.css("width",b.o.maxwidth+"px").vhide().show();var a=b.node.find(".progress-message span").width();b.node.css("width",a+20).vshow()},animate:function(){var a=this;a.left++;a.node.find(".progressbar").css("background-position",a.left+"px 0px")}};(function(a){a.fn.progressbar=function(b){if(this.data("progressbar")){return this.data("progressbar")}return this.each(function(){a(this).data("progressbar",new AboutMe.ProgressBar(this,b))})}})(jQuery);AboutMe.popup=function(a,d){var c=false;d=$.extend({name:null,center:false,centerX:true,centerY:false,relativeTo:"browser",width:600,height:500,left:0,top:100,location:0,menubar:0,resizable:1,scrollbars:1,status:0,toolbar:0},d);var b="height="+d.height+",width="+d.width+",toolbar="+d.toolbar+",scrollbars="+d.scrollbars+",status="+d.status+",resizable="+d.resizable+",location="+d.location+",menuBar="+d.menubar;if(d.center){d.centerX=true;d.centerY=true}if(d.relativeTo=="browser"){if(d.centerX){d.left=WindowInfo.left()+((WindowInfo.width()/2)-(d.width/2))}else{d.left=WindowInfo.left()+d.left}if(d.centerY){d.top=WindowInfo.top()+((WindowInfo.height()/2)-(d.height/2))}else{d.top=WindowInfo.top()+d.top}}else{if(d.centerX){d.left=(screen.availWidth-d.width)/2}if(d.centerY){d.top=(screen.availHeight-d.height)/2}}c=window.open(a,d.name,b+",left="+d.left+",top="+d.top);c.focus();return c};AboutMe.tabs=function(a,b){this.node=$(a);this.o=$.extend({showfirsttab:true,trigger:"a.tab",attr:"href",tab:"div.tab",activeclass:"active",setquery:false,readquery:false,querykey:"#!/",activenode:function(c){return c}},b);this.init()};AboutMe.tabs.prototype={init:function(){var b=this;b.tabs=[];b.node.find(b.o.trigger).each(function(){var d=$(this);var c=d.attr(b.o.attr);var e=$(b.o.tab+c);if(e.length){d.data("tab",e);e.data("trigger",d);b.tabs.push(e)}else{d.remove()}});b.node.find(b.o.trigger).bind("click",function(c){b.showTab(this);c.preventDefault()});if(b.o.readquery){var a=b.checkQuery();if(a){b.o.showfirsttab=false;b.o.showtab=null}$(window).bind("hashchange",function(){b.checkQuery.call(b)})}if(b.o.showtab){var a=b.showTabByName(b.o.showtab);if(a){b.o.showfirsttab=false}}if(b.o.showfirsttab){b.showTab(b.node.find(b.o.trigger)[0])}if(b.o.afterInit){b.o.afterInit.call(b)}},checkQuery:function(){var c=this;var a=parseQuery(c.o.querykey,null,"/",false);var b=false;if(a[0]){b=c.showTabByName(a[0])}return b},showTab:function(b){var d=this;if(d.o.beforeSwitch){var c=d.o.beforeSwitch.call(d);if(!c){return false}}var b=$(b);var a=d.o.activenode(b);if(a.hasClass(d.o.activeclass)){return false}$(d.tabs).each(function(){$(this).hide()});d.node.find(d.o.trigger).each(function(){var e=d.o.activenode($(this));e.removeClass(d.o.activeclass)});b.data("tab").show();a.addClass(d.o.activeclass);d.currenttab=b.data("tab").attr("id");if(d.o.setquery){document.location=d.o.querykey+b.data("tab").attr("id")}if(d.o.afterSwitch){d.o.afterSwitch.call(d)}},showTabByName:function(c){var b=this;var a=$(b.o.tab+"#"+c);if(a.length){b.showTab(a.data("trigger"));return true}return false}};(function(a){a.fn.tabs=function(b){return this.each(function(){a(this).data("tabs",new AboutMe.tabs(this,b))})}})(jQuery);AboutMe.notification={modals:[],config:{modal:{status:"info",buttons:{OK:function(){$(this).dialog("close")}}},modaldefaults:{modal:true,bgiframe:true,draggable:false,resizable:false,closeOnEscape:true},bubble:{status:"info",type:"default",sticky:false,width:250,delayduration:2000,fadeduration:500,minimizeduration:100,minimized:false,multiple:true,mintext:""},banner:{status:"confirmation",duration:5000,fadeduration:1000,position:top},inlinebanner:{visible:true,placement:"prepend",where:"#doccont",showmethod:"slide",status:"info",duration:0,fadeduration:1000,closeable:true,buttons:null},allowed:{statuses:["info","confirmation","warning","error"],placements:["before","after","replace","append","prepend"],showmethods:["slide","fade","show"]}},bubble:{init:function(d,c){if(!d){return}c=$.extend({},AboutMe.notification.config.bubble,c);if(c.status=="ok"){c.status="confirmation"}if($.inArray(c.status,AboutMe.notification.config.allowed.statuses)==-1){throw"Invalid banner status: "+c.status}if(!$(".bubbles").length){$("body").append('<div class="bubbles"></div>')}var b="";b+='<div class="notification bubble bubble-'+c.type+' invisible">';b+='<div class="bubble-content">';b+='<div class="bubble-min"></div>';b+='<div class="bubble-max" style="display:none">';if(c.mintext){b+="<span>"+c.mintext+"</span>"}b+="</div>";b+='<div class="message-content"><div>'+d+"</div></div>";b+="</div>";var a=$(b);a.appendTo("div.bubbles");a.css("width",c.width);if(c.minimized=="true"){$.doTimeout(c.type,c.delayduration,function(){a.removeClass("invisible");AboutMe.notification.bubble.minimize(a,c,true)})}else{$.doTimeout(c.type,c.delayduration,function(){a.fadeIn(c.fadeduration);a.removeClass("invisible")})}$(".bubble-min",a).click(function(){AboutMe.notification.bubble.minimize(a,c)});$(".bubble-max",a).click(function(){AboutMe.notification.bubble.maximize(a,c)});return a},minimize:function(a,e,d){var c=d?0:e.minimizeduration;var b=d?e.fadeduration:0;var f=a.find(".bubble-max").outerWidth(true);a.addClass("minimized",c);a.animate({width:f},c,function(){$(".bubble-min",this).hide();$(".bubble-max",this).fadeIn(b)});$.cookie(e.type+"_minimized","true",{path:"/"})},maximize:function(a,b){$(".bubble-max",a).hide();a.animate({width:b.width},b.minimizeduration,function(){$(".bubble-min",a).show();a.removeClass("minimized",b.minimizeduration)});$.cookie(b.type+"_minimized","false",{path:"/"})}},modal:function(d,c){if(!d){return}var b={};$.extend(b,AboutMe.notification.config.modal,c,AboutMe.notification.config.modaldefaults);if(d.indexOf("<p>")<0){d="<p>"+d+"</p>"}var a=$('<div class="alert-message">'+d+"</div>");b.close=b.close||function(){$(this).dialog("destroy");a.remove()};if(b.status=="error"){b.title=b.title||"It's not you, it's us"}a.dialog(b);if(b.status=="error"){a.parents(".ui-dialog").addClass("ui-dialog-error")}return a},banner:function(g,f){if(!g){return}var b={};$.extend(b,AboutMe.notification.config.banner,f);if(b.status=="ok"){b.status="confirmation"}if($.inArray(b.status,AboutMe.notification.config.allowed.statuses)==-1){throw"Invalid banner status: "+b.status}var c="";c+='<div class="notification banner banner-'+b.status+'">';c+='<div class="banner-wrap">';c+='<div class="banner-content">';c+='<div class="banner-close"></div>';c+='<span class="message-content">'+g+"</span>";c+="</div>";c+="</div>";c+="</div>";var a=$(c);$("body").find(".notification.banner").remove();a.appendTo("body");var e=function(){clearTimeout(a.data("timer"))};var d=function(){e();a.data("timer",setTimeout(function(){a.fadeOut(b.fadeduration)},b.duration))};d();a.find(".banner-content").hover(e,d);a.find(".banner-close").click(function(){e();a.fadeOut("fast")});return a},inlinebanner:function(e,d){if(!e){return}d=$.extend({},AboutMe.notification.config.inlinebanner,d);if(d.dismiss_id&&AboutMe.g.user_profile.dismissed_messages&&AboutMe.g.user_profile.dismissed_messages[d.dismiss_id]){debug("User has dismissed banner ID "+d.dismiss_id);return false}if($.inArray(d.status,AboutMe.notification.config.allowed.statuses)==-1){throw"Invalid banner status: "+d.status}if($.inArray(d.placement,AboutMe.notification.config.allowed.placements)==-1){throw"Invalid banner placement: "+d.placement}var a=$('<div class="notification inlinebanner inlinebanner-'+d.status+'"></div>');if(!d.visible){a.hide()}if(d.id){a.attr("id",d.id)}if(typeof e=="string"){var c="";c+='<div class="banner-content">';if(d.buttons){c+='<div class="buttons-right">';for(var b in d.buttons){c+=d.buttons[b]}c+="</div>"}if(d.title){c+='<p class="title">'+d.title+"</p>"}if(e.indexOf("<p>")<0){e="<p>"+e+"</p>"}c+='<div class="text">'+e+"</div>";c+="</div>";a.append(c)}else{if(typeof e=="object"&&e.jquery){e.clone().addClass("banner-content").removeClass("invisible").appendTo(a);d.placement="replace";d.where=e.selector}else{return}}switch(d.placement){case"before":$(d.where).before(a);break;case"after":$(d.where).after(a);break;case"replace":$(d.where).after(a).remove();break;case"append":$(d.where).append(a);break;case"prepend":$(d.where).prepend(a);break}if(d.closeable){a.addClass("inlinebanner-closeable");a.prepend('<div class="banner-close"></div>');a.find(".banner-close").click(function(){if(d.closefunction){d.closefunction(a,options)}if(d.dismiss_id){AboutMe.notification.dismiss(d.dismiss_id)}switch(d.showmethod){case"slide":a.animate({opacity:0},"fast",function(){a.slideUp("fast",a.remove)});break;case"fade":a.fadeOut("fast",a.remove);break;case"show":a.remove();break}})}if(!d.visible){switch(d.showmethod){case"slide":a.vhide();a.animate({height:"toggle"},"fast",function(){a.hide().vshow().fadeIn("fast")});break;case"fade":a.fadeIn();break;case"show":a.show();break}}return a},dismiss:function(c){var a={dismiss_id:c};var b={success:function(d,e,f,g){},error:function(d,e,f,g){}};AboutMe.ajax.post("dismiss_message",a,b)}};var DirectoryCarousel={defaultmarkup:'<a href="__HREF__" class="example" data-username="__USERNAME__"><span class="thumb"><span class="thumb-wrap"><img class="profilethumb" src="__LOADINGIMG__" alt="__IMGALT__" /></span></span><span class="name">__DISPLAYNAME__</span></a>',init:function(c,f){for(var b in c){try{var a=c[b];f[a.id].people=a.entries;if(f[a.id].randomize){f[a.id].people.sort(function(){return 0.5-Math.random()})}if(f[a.id].alphabetize){f[a.id].people.sort(function(g,e){var h=g[1].toLowerCase(),j=e[1].toLowerCase();if(h<j){return -1}if(h>j){return 1}return 0})}DirectoryCarousel.setup(f[a.id])}catch(d){throw d}}},setup:function(a){if(!a||!a.people){throw"Invalid carousel config."}if(!a.people.length){$(a.selector).empty();$(a.navselector).empty();return}if(typeof(a.paginate)=="undefined"){a.paginate=true}a.cached=[];if(typeof(a.imagePath)!="function"){a.imagePath=DirectoryCarousel.getImagePath}a.markup=a.markup||DirectoryCarousel.defaultmarkup;a.simplepagerthreshold=a.simplepagerthreshold||11;a.people=DirectoryCarousel.manglePeople(a.people);if(a.paginate){DirectoryCarousel.paginate(a)}else{DirectoryCarousel.populate(a)}if(typeof(a.afterSetup)=="function"){a.afterSetup(a)}},generatePersonHTML:function(c,d){var a=c.people[d];var b=c.markup;b=b.replace(/__HREF__/,"http://"+AboutMe.g.DOMAIN_NAME+"/"+a.user);b=b.replace(/__IMGALT__/,a.displayname);b=b.replace(/__DISPLAYNAME__/g,a.displayname);b=b.replace(/__USERNAME__/g,a.user);b=b.replace(/__LOADINGIMG__/g,AboutMe.g.STATIC_HOSTNAME+"/images/directory/loading-"+c.imgsize+".png");return b},populate:function(c){var b="";for(var a=0;a<c.people.length;a++){b+=DirectoryCarousel.generatePersonHTML(c,a)}$(c.selector).html(b);$(c.selector).find("img.profilethumb").each(function(e){var d=c.people[e];if(d){this.onerror=function(){this.src=AboutMe.g.STATIC_HOSTNAME+"/images/directory/thumbnailnotavailable-"+c.imgsize+".png"};this.src=c.imagePath(c.imgsize,d.user)}});DirectoryCarousel.checkActions(c)},paginate:function(c){var b="";b+='<ul class="directory-carousel">';for(var a=0;a<c.people.length;a++){if(a%c.peopleperpage==0){b+='<li class="page clearfix">';c.cached.push(false)}b+=DirectoryCarousel.generatePersonHTML(c,a);if(a%c.peopleperpage==c.peopleperpage-1){b+="</li>"}}if((c.people.length-1)%c.peopleperpage<c.peopleperpage-1){b+="</li>"}b+="</ul>";$(c.selector).html(b);DirectoryCarousel.checkActions(c);c.first=c.first||1;c.first=Math.min(c.first,$(c.selector).find("li").length);$(c.selector).jcarousel({scroll:1,start:c.first,animation:500,buttonNextHTML:null,buttonPrevHTML:null,itemFallbackDimension:900,itemLoadCallback:function(){},initCallback:function(e){e.which=c;e.node=$(c.selector);e.nav=$(c.navselector);e.nav.empty();if(e.options.size>1){e.nav.append('<span class="button button-small button-blue button-first"><span class="button-content">&laquo;</span></span>');if(c.linkpagenumbers&&e.options.size<c.simplepagerthreshold){for(var d=1;d<=e.options.size;d++){e.nav.append('<span class="button button-small button-blue"><span class="button-content">'+d+"</span></span>")}}else{e.nav.append('<span class="button button-small button-blue button-active"><span class="button-content">1 of '+e.options.size+"</span></span>")}e.nav.append('<span class="button button-small button-blue button-last"><span class="button-content">&raquo;</span></span>')}e.first=c.first;DirectoryCarousel.updateCarouselNav(e);DirectoryCarousel.preloadPage(e,0);e.nav.find(".button").not(".button-first, .button-last").bind("click",function(){var g=$(this);if(g.hasClass("button-active")){return false}var f=$.jcarousel.intval(g.text());DirectoryCarousel.preloadPage(e,f);e.scroll(f);DirectoryCarousel.updateCarouselNav(e);return false});e.nav.find(".button-last").bind("click",function(){e.next();DirectoryCarousel.updateCarouselNav(e);return false});e.nav.find(".button-first").bind("click",function(){e.prev();DirectoryCarousel.updateCarouselNav(e);return false})}})},checkActions:function(c){if(AboutMe.g.user_profile&&AboutMe.g.user_profile.user_name&&c.actions){if(!c.actionsIndexed){var b={};for(var a in c.actions){b[c.actions[a]]=true}c.actions=b;c.actionsIndexed=true}DirectoryCarousel.addActionMenu(c)}},addActionMenu:function(d){var a=$(d.selector).find(".example");var b="";b+='<div class="menu rightmenu profilethumbmenu">';b+='<div class="menu-toggle"><div class="icon-gear">&nbsp;</div></div>';b+='<div class="menu-content">';b+='<ul class="menu-items">';if(d.actions.fave){b+='<li class="item"><span class="icon-fave">Fave this Profile</span></li>'}if(d.actions.fave&&d.actions.flag){b+='<li class="separator"><hr /></li>'}if(d.actions.flag){b+='<li class="item"><span class="icon-flag">Flag this Profile for Abuse</span></li>'}b+="</ul>";b+="</div>";b+="</div>";a.append(b);a.each(function(){var e=$(this);var f=e.closest(".example").attr("data-username");e.hover(function(){$.doTimeout("hovermenu-"+f,500,function(){e.find(".menu").not(".visible").addClass("visible").css("opacity",0).show().animate({opacity:1},150)})},function(){$.doTimeout("hovermenu-"+f,500,function(){e.find(".menu").removeClass("visible").animate({opacity:0},250,function(){e.find(".menu").removeClass("menu-active").hide();e.find(".menu-content").hide()})})});e.click(function(){if(e.find(".menu-active").length){e.find(".menu-active").removeClass("menu-active");e.find(".menu-content").fadeOut(250);return false}});e.find(".menu-toggle").click(AboutMe.menu.toggle);e.find("li.item span").click(AboutMe.menu.hide)});a.find("span.icon-fave").click(function(){var l=$(this);var m=l.closest(".example").attr("data-username");var j=l.closest(".example").find(".name").text();var f={action:"add",users:JSON.stringify([m])};var k=function(){l.unbind("click");l.click(function(){return false});l.closest("li").removeClass("item").addClass("disabled")};var e=function(n,o,p,q){k();AboutMe.banner(j+' has been added to your <a href="/dashboard/#!/favorites">Favorites</a>.')};var h=function(n,o,p,q){if(n.error==100){k();AboutMe.banner(j+' is already in your <a href="/dashboard/#!/favorites">Favorites</a>.',{status:"warning"})}else{if(n.error==101){k();AboutMe.banner("You can't add your own profile to your Favorites.",{status:"warning"})}else{AboutMe.banner("There was a problem adding "+j+" to your Favorites. Please try again later.",{status:"error"})}}};var g={success:e,error:h};AboutMe.ajax.post("personal_directory",f,g);l.closest(".example").find(".menu").removeClass("menu-active");l.closest(".menu-content").fadeOut(250);return false});var c=function(f){if(f!=true){return}var k=$(this);var g=k.closest(".example").attr("data-username");var e=k.closest(".example").find(".name").text();var l={action:"flag",user:g};var h=function(){k.unbind("click");k.click(function(){return false});k.closest("li").removeClass("item").addClass("disabled")};var j=function(o,p,q,r){h();AboutMe.banner("This profile has been flagged for review.")};var n=function(o,p,q,r){AboutMe.banner("There was a problem flagging this profile. Please try again later.",{status:"warning"});debug(o)};var m={success:j,error:n};AboutMe.ajax.post("flag",l,m);k.closest(".example").find(".menu").removeClass("menu-active");k.closest(".menu-content").fadeOut(250);return false};a.find("span.icon-flag").click(function(){var e=this;AboutMe.confirm("Are you sure you want to flag this profile for abuse?",function(f){c.apply(e,[f])});return false})},preloadPage:function(b,a){if(a<0){return}if(a>=b.which.cached.length){return}if(b.which.cached[a]){return}b.node.find("li.page").eq(a).find("img").each(function(d){var c=b.which.people[(a*b.which.peopleperpage)+d];if(c){this.onerror=function(){this.src=AboutMe.g.STATIC_HOSTNAME+"/images/directory/thumbnailnotavailable-"+b.which.imgsize+".png"};this.src=b.which.imagePath(b.which.imgsize,c.user)}});b.which.cached[a]=true},getImagePath:function(a,b){return AboutMe.g.AWS_THUMBNAIL+"/thumbnail/system_directory/"+a+"/"+b+".jpg"},manglePeople:function(c){if(!c.length){throw"Invalid people array."}if(c[0].displayname){return c}if(c[0].first){for(var d=0;d<c.length;d++){var a="";if(c[d].first){a+=c[d].first}if(c[d].first&&c[d].last){a+=" "}if(c[d].last){a+=c[d].last}c[d].displayname=a}return c}var e=[];for(var d=0;d<c.length;d++){var b={};b.user=c[d][0];b.displayname=c[d][1];e.push(b)}return e},updateCarouselNav:function(c){var a=c.first;if(a>c.options.size){a=a%c.options.size}c.nav.each(function(){var e=$(this).find(".button").not(".button-first, .button-last");if(c.which.linkpagenumbers&&c.options.size<c.which.simplepagerthreshold){e.removeClass("button-active");e.eq(a-1).addClass("button-active")}else{e.eq(0).find("span.button-content").html(a+" of "+c.options.size)}});var b=c.nav.find(".button-first");if(a!=1){b.removeClass("button-disabled")}else{b.addClass("button-disabled")}var d=c.nav.find(".button-last");if(a!=c.options.size){d.removeClass("button-disabled")}else{d.addClass("button-disabled")}DirectoryCarousel.preloadPage(c,a-1);DirectoryCarousel.preloadPage(c,a+1);if(typeof(c.which.afterScroll)=="function"){c.which.afterScroll(c.which)}}};var Bevel={getDecimalTriplet:function(a){var b=new Array();b[0]=parseInt(a.slice(0,2),16);b[1]=parseInt(a.slice(2,4),16);b[2]=parseInt(a.slice(4),16);return b},getHexByte:function(a){var b=a.toString(16);if(b.length<2){b="0"+b}return(b)},getHexTriplet:function(a){var b=Bevel.getHexByte(a[0])+Bevel.getHexByte(a[1])+Bevel.getHexByte(a[2]);return(b)},shiftAxis:function(j){var l=50;var e=20;var g=255-j;var h=Math.min(g,j);var f=127-h;var b=Math.floor((l-e)*(f/127));var c=e+b;var a=(Math.pow(j,4)/Math.pow(255,4))+1;var d=Math.min(255,Math.floor(j+(c)));var k=Math.max(0,Math.floor(j-(a*c)));return([d,k])},getBevelColors:function(b){var e=Bevel.getDecimalTriplet(b);var a=new Array();a[0]=new Array();a[1]=new Array();for(key in e){var c=Bevel.shiftAxis(e[key]);a[0].push(c[0]);a[1].push(c[1])}var d=new Array();d[0]="#"+Bevel.getHexTriplet(a[0]);d[1]="#"+Bevel.getHexTriplet(a[1]);return(d)},updateBevel:function(b){var c="1px solid #000";var a="1px solid #fff";$("#profile-bevel").css({height:"0px",background:"transparent","border-top":c,"border-bottom":a,opacity:Math.floor(UserSettings.colors.profile_opacity*0.2)/100})}};var TypeTools={selectors:{font_name:".profile div.profile-head h1.name",font_heading:".profile div.profile-head h2.headline",font_bio:".profile div.bio",font_findme:".profile ul.links"},profilewidthtimer:null,fontLoad:function(e){$("#font_loader").show();if(window.Customize&&Customize.Notifier){Customize.Notifier.hide()}var f=true;for(i=0;i<e.items.length;i++){if(e.items[i][0]){var d=e.items[i][1];var c=d.split(",");var a=TypeTools.selectors[e.items[i][0]];if(!$.fontAvailable(c[0])){f=false;var b=TypeTools.fontSwitch(d);TypeTools.typekitLoad(b[0],a,c,b[1])}else{TypeTools.checkProfileWidth();var b=TypeTools.fontSwitch(d);$(a).css("font-weight",b[1]).vshow();$("#font_loader").hide()}}}return f},fontShow:function(a,c,b){var d=0;$.doTimeout("font_check_"+a,100,function(){if($.fontAvailable(c[0])){$("#font_loader").hide();TypeTools.checkProfileWidth();$(a).css("font-weight",b).vshow();return false}try{Typekit.load()}catch(f){}d++;if(d==50){TypeTools.visibilityFailsafe()}return true})},typekitLoad:function(c,a,e,d){var b=document.createElement("script");b.type="text/javascript";b.src="http://use.typekit.net/"+c+".js";$("head").append(b);TypeTools.fontShow(a,e,d)},fontSwitch:function(b){var c="";switch(b){case"apertura-condensed-1,apertura-condensed-2":c="wui7tzd";fontWeight="400";break;case"bree-1,bree-2":c="qco1rxr";fontWeight="400";break;case"facitweb-1,facitweb-2":c="bjy5ffq";fontWeight="400";break;case"ff-dagny-web-pro-1,ff-dagny-web-pro-2":c="qrp4luu";fontWeight="400";break;case"ff-meta-web-pro-1,ff-meta-web-pro-2":c="msy3yks";fontWeight="400";break;case"museo-sans-1,museo-sans-2":c="hux7bsa";fontWeight="500";break;case"ratio-1,ratio-2":c="fwa3mli";fontWeight="400";break;case"ronnia-condensed-1,ronnia-condensed-2":c="rsw0vsk";fontWeight="400";break;case"kulturista-web-1,kulturista-web-2":c="lvf1gol";fontWeight="400";break;case"museo-slab-1,museo-slab-2":c="hpq8rua";fontWeight="300";break;case"sommet-slab-1,sommet-slab-2":c="kmp0kte";fontWeight="400";break;case"calluna-1,calluna-2":c="lsi5lcd";fontWeight="400";break;case"ff-tisa-web-pro-1,ff-tisa-web-pro-2":c="gmw2nyl";fontWeight="400";break;case"lemonde-journal-1,lemonde-journal-2":c="zyb0bhk";fontWeight="400";break;case"skolar-1,skolar-2":c="kzj0ary";fontWeight="400";break;case"atrament-web-1,atrament-web-2":c="czs0vob";fontWeight="400";break;case"aurea-ultra-1,aurea-ultra-2":c="vpt1bkg";fontWeight="400";break;case"bello-pro-1,bello-pro-2":c="orm4uip";fontWeight="400";break;case"coquette-1,coquette-2":c="ehk1rys";fontWeight="400";break;case"snicker-1,snicker-2":c="mga4wgv";fontWeight="700";break;case"ff-masala-script-web-pro-1,ff-masala-script-web-pro-2":c="orw5trp";fontWeight="400";break;case"maryam-1,maryam-2":c="cfi2mev";fontWeight="400";break;case"bigsmalls-bold-1,bigsmalls-bold-2":c="wvp1hks";fontWeight="700";break;case"continuo-1,continuo-2":c="qum0tsj";fontWeight="400";break;case"corner-store-1,corner-store-2":c="noa2nbd";fontWeight="400";break;case"ff-prater-block-web-1,ff-prater-block-web-2":c="arb0imk";fontWeight="400";break;case"blackout-2am-1,blackout-2am-2":c="vql6afj";fontWeight="400";break;case"teeshirt-1,teeshirt-2":c="qfj1esm";fontWeight="400";break;case"kegger-collegiate-1,kegger-collegiate-2":c="yic6uet";fontWeight="400";break;case"jbt-annabelle-1,jbt-annabelle-2":c="cau7nof";fontWeight="400";break;case"proxima-nova-1,proxima-nova-2":c="vfg7kbz";fontWeight="400";break;case"aviano-flare-1,aviano-flare-2":c="sna7vtd";fontWeight="500";break;case"english-small-caps-1,english-small-caps-2":c="yat5lvk";fontWeight="400";break;case"felt-tip-roman-1,felt-tip-roman-2":c="gpu3kib";fontWeight="800";break;case"swingdancer-1,swingdancer-2":c="hih5rwq";fontWeight="500";break;case"good-times-1,good-times-2":c="pqu3gdz";fontWeight="300";break;case"lobster-1,lobster-2":c="ofi8jom";fontWeight="400";break;case"futura-pt-1,futura-pt-2":c="qhq1tjz";fontWeight="400";break}var a=[c,fontWeight];return a},checkProfileWidth:function(a){clearTimeout(TypeTools.profilewidthtimer);TypeTools.profilewidthtimer=setTimeout(function(){TypeTools.updateProfileWidth(a)},100)},updateProfileWidth:function(d){d=d||{};clearTimeout(TypeTools.profilewidthtimer);var e=$("div.profile div.profile-head");var c=e.width()+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right"));var b=$("div.profile ul.links");var f=b.width()+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right"));var a=Math.max(c,f);if(UserSettings.profile_width!=a){UserSettings.profile_width=a;$("div.profile .profile-content").animate({width:a+"px"},100);if(window.Customize&&Customize.Saver&&d.save){Customize.Saver.save("profile_width",a)}}TypeTools.checkAvatarHeight()},visibilityFailsafe:function(){for(key in TypeTools.selectors){TypeTools.checkProfileWidth();$(TypeTools.selectors[key]).show().vshow()}$("#font_loader").hide()},checkAvatarHeight:function(a){clearTimeout(TypeTools.avatarheighttimer);TypeTools.avatarheighttimer=setTimeout(function(){TypeTools.updateAvatarHeight(a)},100)},updateAvatarHeight:function(b){var g=$(".profile div.profile_photo");if(!g.length){return}if(!$(".avatartest").length){$("body").append('<div class="avatartest"></div>');$(".avatartest").append("<img />");var n=function(){UserSettings.images.avatar_width=$(".avatartest img").width();UserSettings.images.avatar_height=$(".avatartest img").height();TypeTools.checkAvatarHeight()};$(".avatartest img").load(function(){setTimeout(n,10)}).attr("src",UserSettings.images.avatar_image);return}var e=(g.find("img").height()<10);var k=$(".profile div.bio");var j=Math.min(parseInt(k.width()*0.5),UserSettings.images.avatar_width);var m=parseInt(k.css("font-size"));var h=parseInt(m*1.5);var l=parseInt(g.css("padding-top"));if(!b){if(m<=6){l=l*2;var b=12}else{if(m>=6&&m<=10){l=l*2;var b=6}else{if(m>=30&&m<=50){var b=3}else{if(m>=50){var b=2}else{var b=4}}}}}var a=parseInt((h*b)+m-(l*0.75));var f=k.offset().top;$(".profile .bio p, .profile .bio ol, .profile .bio ul").not(":first").each(function(){if($(this).offset().top-f<a+h+m){a+=parseInt(m*0.75)}});var c=UserSettings.images.avatar_width/UserSettings.images.avatar_height;var d=Math.round(a*c);if(d<j){$.doTimeout("smart_avatar",100,function(){if(e){g.find("img").css({width:"auto",height:a+"px"});TypeTools.checkAvatarHeight()}else{g.find("img").css({width:"auto"}).animate({height:a+"px"},100)}g.css("padding-right",parseInt(m*0.75)+"px")})}else{if(b>1){TypeTools.checkAvatarHeight(b-1)}else{var d=j;g.find("img").css({width:d+"px",height:"auto"})}}}};var Carousel={single:{},insert:function(e,a,g){var h=[];var b=[];if(e.main_element){$(e.main_element).closest(".carousel").css("background","url("+AboutMe.g.STATIC_HOSTNAME+"/images/ajax/ajax-loader-alt2.gif) center center no-repeat")}switch(a){case"instagram":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i==0){c+="current "}if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";if(e.items[i][3]=="1"){var f="Comment"}else{var f="Comments"}if(e.items[i][2]=="1"){var d="Like"}else{var d="Likes"}h.push('<li><a href="'+e.items[i][1]+'" target="_blank"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][5]+'" alt="instagram snap" /></a><div class="instagram-image-info"><div class="instagram-info-column left"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/icons/icon_instagram_like.png" />'+e.items[i][2]+"&nbsp;"+d+'</div><div class="instagram-info-column middle"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/icons/icon_instagram_comment.png" />'+e.items[i][3]+"&nbsp;"+f+'</div><div class="instagram-info-column right"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/icons/icon_instagram_lens.png" />'+e.items[i][4]+"</div></div></li>");b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 30px no-repeat;"><a href="#"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="Instagram thumb" /></a></li>')}break;case"bgSaved":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(UserSettings.images.background_image==e.items[i][1]){c+="current "}c+="'";var j=$("div.displayname").text();var k="<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 40px no-repeat;"><a href="#" id="'+e.items[i][1]+'" class="saved_bg theme_background"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" /></a>';if(e.items[i][2]){k+='<span class="background-sig">';if(e.items[i][5]){k+='<a href="'+e.items[i][5]+'">'+e.items[i][2]+"</a>"}else{k+=e.items[i][2]}if(e.items[i][3]){k+='<br />by <a href="'+e.items[i][4]+'">'+e.items[i][3]+"</a>"}k+="</span>"}k+='<span class="remove-thumb">&nbsp;</span><span class="remove-confirm"><p class="confirmtext">Delete this image?</p><p class="buttons clearfix"><span class="button button-xsmall button-default"><span class="button-content">Yes</span></span><span class="button button-xsmall button-cancel"><span class="button-content">No</span></span></p></span></li>';b.push(k)}break;case"bgCustom":for(i=0;i<e.items.length;i=i+1){var k='<li style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 40px no-repeat;"><a href="#" id="'+e.items[i][1]+'" class="theme_background"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" /></a><span class="background-sig">';if(e.items[i][5]){k+='<a href="'+e.items[i][5]+'">'+e.items[i][2]+"</a>"}else{k+=e.items[i][2]}if(e.items[i][3]){k+='<br />by <a href="'+e.items[i][4]+'">'+e.items[i][3]+"</a>"}k+="</span></li>";b.push(k)}break;case"dailybooth":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i==0){c+="current "}if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";e.items[i][2]=e.items[i][0].replace(/tiny/,"large");e.items[i][0]=e.items[i][0].replace(/tiny/,"small");h.push('<li><table class="valign"><tr><td class="valign-inside"><a href="'+e.items[i][1]+'" target="_blank"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][2]+'" alt="DailyBooth snap" /></a></td></tr></table></li>');b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 35px no-repeat;"><table class="valign"><tr><td class="valign-inside"><a href="#"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="DailyBooth snap thumb" /></a></td></tr></table></li>')}break;case"facebookpage_photos":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i==0){c+="current "}if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";h.push('<li><table class="valign"><tr><td class="valign-inside"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="Facebook photo" /></td></tr></table></li>');b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 30px no-repeat;"><table class="valign"><tr><td class="valign-inside"><a href="#"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="Facebook photo thumb" /></a></td></tr></table></li>')}break;case"facebookpage_videos":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i==0){c+="current "}if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";h.push('<li><table class="valign"><tr><td class="valign-inside"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" title="Facebook video player" class="facebook-player video-player video-player-flash" width="580" height="360" data-src="'+e.items[i][5]+'" /></td></tr></table><div class="video-main-descrip"><h2>'+e.items[i][3]+"</h2><p>by "+e.items[i][2]+' : <a href="http://www.facebook.com/video/video.php?v='+e.items[i][0]+'">'+e.items[i][1]+"</a></p></div></li>");b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 50px no-repeat;"><a href="#"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][4]+'" alt="Facebook video thumb" /></a><br /><span class="title">'+e.items[i][3]+'</span><br /><span class="author">by <a href="http://www.facebook.com/video/video.php?v='+e.items[i][0]+'">'+e.items[i][2]+"</a></span></li>")}break;case"flickr":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i==0){c+="current "}if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";h.push('<li><table class="valign"><tr><td class="valign-inside"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="http://farm'+e.items[i][0]+".static.flickr.com/"+e.items[i][1]+"/"+e.items[i][2]+"_"+e.items[i][3]+'.jpg" alt="Flickr photo" /></td></tr></table></li>');b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 30px no-repeat;"><a href="#"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="http://farm'+e.items[i][0]+".static.flickr.com/"+e.items[i][1]+"/"+e.items[i][2]+"_"+e.items[i][3]+'_s.jpg" alt="Flickr photo thumb" /></a></li>')}break;case"facebook_photos":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center center no-repeat;"><table class="valign"><tr><td class="valign-inside"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="Facebook photo thumb" /></td></tr></table></li>')}break;case"facebook_friends":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center center no-repeat;"><table class="valign"><tr><td class="valign-inside"><a href="http://www.facebook.com/profile.php?id='+e.items[i][0]+'"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="http://graph.facebook.com/'+e.items[i][0]+'/picture" alt="Facebook profile thumb" class="item" /><span class="friend_caption">'+e.items[i][1]+'<img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/icons/friends_down_arrow.png" alt="" /></span></a></td></tr></table></li>')}$(e.element).find("a").hover(function(){var m=($(this).find(".friend_caption").width()/2)+7;var l=$(this).find("img:eq(0)").offset();$(this).find(".friend_caption").clone().appendTo("body").addClass("bodied").css({display:"block",marginLeft:"-"+m+"px",top:l.top+"px",left:(l.left+25)+"px"})},function(){$(".friend_caption.bodied").remove()});break;case"foursquare_friends":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center center no-repeat;"><table class="valign"><tr><td class="valign-inside"><a href="http://www.foursquare.com/user/'+e.items[i][1]+'" target="_blank"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="Foursquare friend thumb" class="item" /></a></td></tr></table></li>')}break;case"foursquare_badges":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center center no-repeat;"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="Foursquare badge" class="item" /></li>')}break;case"vimeo":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i==0){c+="current "}if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";h.push('<li><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" title="Vimeo video player" class="vimeo-player video-player" width="580" height="360" data-src="http://player.vimeo.com/video/'+e.items[i][1]+'?title=0&byline=0&portrait=0&color=ffffff" /><div class="video-main-descrip"><h2>'+e.items[i][2]+'</h2><p>by <a href="'+e.items[i][3]+'">'+e.items[i][4]+"</a> : "+e.items[i][5]+" : "+e.items[i][6]+" views</p></div></li>");e.items[i][0]=e.items[i][0].replace(/_100/,"_200");b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 50px no-repeat;"><a href="#"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="Vimeo video thumb" /></a><br /><span class="title">'+e.items[i][2]+'</span><br /><span class="author">by <a href="'+e.items[i][3]+'">'+e.items[i][4]+"</a></span></li>")}break;case"youtube":for(i=0;i<e.items.length;i=i+1){var c=" class='";if(i==0){c+="current "}if(i<e.items_num){c+="visible "}else{c+="notVisible "}c+="'";h.push('<li><img title="YouTube video player" src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" class="youtube-player video-player" width="580" height="360" data-src="http://www.youtube.com/embed/'+e.items[i][1]+'?rel=0&amp;autoplay=0&amp;loop=0&amp;wmode=Opaque" frameborder="0" /><div class="video-main-descrip"><h2>'+e.items[i][2]+'</h2><p>by <a href="'+e.items[i][3]+'">'+e.items[i][4]+"</a> : "+e.items[i][5]+" : "+e.items[i][6]+" views</p></div></li>");b.push("<li"+c+' style="background:url('+AboutMe.g.STATIC_HOSTNAME+'/images/ajax/ajax-loader-alt2.gif) center 50px no-repeat;"><a href="#"><img src="'+AboutMe.g.STATIC_HOSTNAME+'/images/blank.gif" data-src="'+e.items[i][0]+'" alt="youtube video thumb" /></a><br /><span class="title">'+e.items[i][2]+'</span><br /><span class="author">by <a href="'+e.items[i][3]+'">'+e.items[i][4]+"</a></span></li>")}break}if(h.length>0){h=h.join("");$(e.main_element).append(h)}if(b.length>0){b=b.join("");$(e.element).append(b)}Carousel.mainNavButtons()},pagination:function(b,a){if(!a){a=1}if(b.items.length>1){$(b.element).jcarousel({scroll:b.items_num,size:b.items.length,start:a,animation:500,buttonNextHTML:null,buttonPrevHTML:null,itemFallbackDimension:b.width,buttonNextCallback:function(e,d,c){if(b.items.length>b.items_num){if(c==false){$(b.next).addClass("inactive")}else{$(b.next).removeClass("inactive")}}},buttonPrevCallback:function(e,d,c){if(c===false){$(b.prev).addClass("inactive")}else{$(b.prev).removeClass("inactive")}},initCallback:function(c){if($(b.element+" .jcarousel-item").length!=c.options.size){c.options.size=$(b.element+" .jcarousel-item").length}$(b.element+" .visible").each(function(){MediaTools.displayItem($(this))});if(b.main_element){$(b.element+" .jcarousel-item").bind("click",function(){$(b.element+" .current").removeClass("current");$(this).addClass("current");var d=($(this).index()+1);$(b.main_element).jcarousel("scroll",d);return false})}},itemLoadCallback:{onBeforeAnimation:function(d,c){$(b.next).unbind("click");$(b.prev).unbind("click")},onAfterAnimation:function(d,c){$(b.next).bind("click",function(){d.next();return false});$(b.prev).bind("click",function(){d.prev();return false})}},itemVisibleInCallback:{onBeforeAnimation:function(f,d,c,e){MediaTools.displayItem($(d));$(d).addClass("visible").removeClass("notVisible")}},itemVisibleOutCallback:{onBeforeAnimation:function(f,d,c,e){$(d).addClass("notVisible").removeClass("visible")}}});if(b.main_element){$(b.main_element).jcarousel({scroll:1,size:b.items.length,animation:300,buttonNextHTML:null,buttonPrevHTML:null,itemFallbackDimension:b.main_width,buttonNextCallback:function(e,d,c){if(c===false){$(b.main_next).addClass("inactive")}else{$(b.main_next).removeClass("inactive")}},buttonPrevCallback:function(e,d,c){if(c===false){$(b.main_prev).addClass("inactive")}else{$(b.main_prev).removeClass("inactive")}},initCallback:function(c){$(b.main_next).bind("click",function(){c.next();return false});$(b.main_prev).bind("click",function(){c.prev();return false})},itemVisibleInCallback:{onBeforeAnimation:function(f,d,c,e){var g=b.element.replace(/#/,"").replace(/./,"");$.doTimeout(g,500,function(){if($(b.element+" li:eq("+(c-1)+")").hasClass("notVisible")){$(b.element).jcarousel("scroll",c)}$(b.element+" .current").removeClass("current");$(b.element+" li:eq("+(c-1)+")").addClass("current");MediaTools.displayItem($(d))})}},itemVisibleOutCallback:{onAfterAnimation:function(f,d,c,e){Carousel.stopPlayback($(d))}}})}}else{MediaTools.displayItem($(b.element+" li"));if(b.main_element){MediaTools.displayItem($(b.main_element+" li"))}}},stopPlayback:function(b){if(b){var a=b.find("iframe");var c=a.attr("src");a.removeAttr("src").attr("src",c)}else{$(".app iframe").each(function(d,e){var e=$(e);var f=e.attr("src");e.removeAttr("src").attr("src",f)})}},hotLoad:function(a,c,b){if(!b){b=1}if(!a){a=""}switch(c){case"facebook":if(Carousel.single["facebook_photos_"+a]){Carousel.pagination(Carousel.single["facebook_photos_"+a],b)}if(Carousel.single["facebook_friends_"+a]){Carousel.pagination(Carousel.single["facebook_friends_"+a],b)}break;case"facebookpage":if(Carousel.single["facebookpage_photos_"+a]){Carousel.pagination(Carousel.single["facebookpage_photos_"+a],b)}if(Carousel.single["facebookpage_videos_"+a]){Carousel.pagination(Carousel.single["facebookpage_videos_"+a],b)}break;case"foursquare":if(Carousel.single["foursquare_badges_"+a]){Carousel.pagination(Carousel.single["foursquare_badges_"+a],b)}if(Carousel.single["foursquare_friends_"+a]){Carousel.pagination(Carousel.single["foursquare_friends_"+a],b)}break;case"twitter":$(".app.twitter img.avatar").each(function(d){MediaTools.displayItem($(this))});break;case"":break;default:service=Carousel.single[c+"_"+a];if(service){Carousel.pagination(service,b)}}},mainNavButtons:function(){$("body").on("mouseover mouseout",".carousel.size580",function(a){if(a.type=="mouseover"){$(this).find("span.main-button:not(.inactive)").show()}else{$(this).find("span.main-button:not(.inactive)").hide()}})}};var MediaTools={displayItem:function(d){var f=d.get(0);if(f&&(f.tagName=="IMG")){var b=d.attr("data-src");if(b&&!d.hasClass("loaded")){d.attr("src",b).removeAttr("data-src").addClass("loaded")}}else{if(f&&f.tagName!="IMG"){var c=d.find("img:eq(0)");if(c){var b=c.attr("data-src")}if(b&&c.hasClass("video-player")){var a=c.attr("width");var e=c.attr("height");if(c.hasClass("video-player-flash")){b=c.attr("data-src");c.replaceWith(b)}else{c.replaceWith("<iframe class='loaded' src='"+b+"' frameborder='0' type='text/html' width='"+a+"' height='"+e+"'></iframe>")}}else{if(b){d.css("background-image","none");c.not(".loaded").attr("src",b).addClass("loaded")}}}}}};var UserProfile={init:function(){$(window).bind("load",function(){TypeTools.checkProfileWidth();UserProfile.offScreenFix()});$(window).resize(UserProfile.windowResizeFix);UserProfile.rgbaCheck();UserProfile.updateProfileColor();UserProfile.createIconMenus();UserProfile.setLinkLineHeight();TypeTools.checkProfileWidth();$("body").on("typekit_loaded",function(){TypeTools.checkProfileWidth()});$("#large_avatar_container").dialog({autoOpen:false,dialogClass:"avatar",bgiframe:true,modal:true,draggable:false,position:"center",resizable:false,height:"auto",width:"auto",closeOnEscape:true,open:function(a,b){var c=parseInt($("#large_avatar_container").width());$("#large_avatar_container").siblings("div.ui-dialog-titlebar").css("width",c+20+"px")},close:function(a,b){$("#large_avatar_container").siblings("div.ui-dialog-titlebar").css("width","auto")}});$("body").on("click","#profile_picture",function(){$("#large_avatar_container").dialog("open")});$("#emailme").dialog({autoOpen:false,bgiframe:true,modal:true,width:550,draggable:false,resizable:false,buttons:{Send:function(){$(".alarum").hide();valid=true;if($("#message_text").val().length==0){valid=false;$("#message_invalid").show()}if($("#message_name").val().length==0){valid=false;$("#name_invalid").show()}if($("#message_email").val().length==0||!validEmail($("#message_email").val())){valid=false;$("#email_invalid").show()}if(!valid){return}$("#emailme").parent().find(".ui-dialog-buttonpane").hide();$("#send_message_loader").show();$.ajax({type:"POST",url:"/send_message/"+UserSettings.user_name,data:{message:$("#message_text").val(),name:$("#message_name").val(),email:$("#message_email").val()},success:function(a){$(".loader").hide();if(a.success==true){$("#emailme").dialog("close");$("#emailme").html("<p>You cannot email this user again right now. Please try again tomorrrow.</p>");AboutMe.banner("Your message has been sent!")}else{$("#message_error").show().html(a.error);$("#emailme").parent().find(".ui-dialog-buttonpane").show()}},dataType:"json"})}},open:function(a,b){$("#emailme .alarum").hide();$(".ui-dialog-cancel-link").remove();$("#emailme").parent().find(".ui-dialog-buttonpane").append('<span class="ui-dialog-cancel-link">or <a href="#" id="send_no">Cancel</a></span>');$("#send_no").click(function(){$("#emailme").dialog("close")})}});$(".emailmebutton").click(function(){$("#emailme").dialog("open")});$("#askmeaquestion").dialog({autoOpen:false,bgiframe:true,modal:true,width:550,draggable:true,resizable:false,buttons:{Ask:function(){$(".alarum").hide();valid=true;if($("#question_text").val().length==0){valid=false;$("#question_text_invalid").show()}if(!valid){return}$("#emailme").parent().find(".ui-dialog-buttonpane").hide();$("#send_message_loader").show();$.ajax({type:"POST",url:"/send_message/"+UserSettings.user_name,data:{question:$("#message_subject").val(),message:$("#message_text").val(),name:$("#message_name").val(),email:$("#message_email").val()},success:function(a){$(".loader").hide();if(a.success==true){$("#emailme").html('<div class="clear skip twenty"></div><div>Your message has been sent!</div>');$("#emailme").parent().find(".ui-dialog-buttonpane").empty();$("#emailme").parent().find(".ui-dialog-buttonpane").append('<button type="submit" onclick="$(\'#emailme\').dialog(\'close\')" class="button">Ok, Thanks!</button>')}else{$("#message_error").show().html(a.error);$("#emailme").parent().find(".ui-dialog-buttonpane").show()}},dataType:"json"})}},open:function(a,b){$("#emailme .alarum").hide();$(".ui-dialog-cancel-link").remove();$("#emailme").parent().find(".ui-dialog-buttonpane").append('<span class="ui-dialog-cancel-link">or <a href="#" id="send_no">Cancel</a></span>');$("#send_no").click(function(){$("#emailme").dialog("close")})}});$(".askmeaquestionbutton").click(function(){$("#askmeaquestion").dialog("open")});$("#share-profile").dialog({autoOpen:false,bgiframe:true,title:"Share This Profile",modal:true,width:550,draggable:false,resizable:false});$("#share-profile-modal").click(function(){$("#share-profile").dialog("open")});$(".button").disableSelection();UserProfile.showHideContactBar();UserProfile.buttonbarReround("contactbar");if(UserSettings.images.background_repeat=="scale"&&UserSettings.images.background_image){$.backstretch(UserSettings.images.background_image)}FaveProfile.init();FlagProfile.init();ServicesModal.init();AV.init()},buttonbarReround:function(c){var a=$("."+c);var b=a.find(".button");b.removeClass("button-first button-last");b.filter(":visible").first().addClass("button-first");b.filter(":visible").last().addClass("button-last")},createIconMenus:function(){var a=$("#service-icons-setup");var b=$("#service-icons");b.find(".service-icon").remove();b.prepend(a.html());b.find('li.service-icon[data-platform="facebookpage"]').attr("data-platform","facebook");b.find("li.service-icon").each(function(d,h){h=$(h);var c=h.attr("data-platform");var g=b.find("li.service-icon[data-platform="+c+"]");var f=g.not(":first").removeClass("service-icon").detach();if(f.length){var j=g.first().clone().detach();j.removeClass("service-icon");g.first().addClass("service-icon-parent menu").find("a.icon").addClass("menu-toggle").end().append('<ul class="service-icon-group menu-content menu-items"></ul>');b.find('li.service-icon[data-platform="'+c+'"] ul').append(j,f);b.find('li.service-icon[data-platform="'+c+'"] ul li').each(function(e,l){l=$(l);var k=l.attr("data-name");l.find("a").css("background-image","none").text(k)})}})},offScreenFix:function(){var e=$(".profile"),x=$(".background-container"),h=$("#header-background, #header-wrap"),t=$("#services_modal"),f=$(".customize"),k=$(window).height();x.css({width:"100%",height:(k-AboutMe.g.NAV_HEIGHT)+"px"});h.css({width:"100%"});var s=e.offset().left,p=e.offset().top,n=e.width(),w=e.height(),a=p+w,q=s+n,g=t.offset().top,m=t.height(),o=g+m,d=x.width(),l=x.height();if(q>d){q=q+(q-d)+50;x.css({width:q+"px"});h.css({width:q+"px"})}else{x.css({width:"100%"});h.css({width:"100%"})}var r=Math.max(a,o);if(f.length>0){var u=f.width(),b=f.offset().left,c=f.height(),v=f.offset().top,j=v+c,z=u+b;if(b<0){f.css({left:"20px",marginLeft:"0px"})}if(z>d){f.css({left:(d-u-20)+"px",marginLeft:"0px"})}r=Math.max(a,o,j)}if(r>l){r=r+150;x.css({height:r+"px"})}if(s<0){var y=(Math.abs(s)*2)+20;d=d+y;x.css({width:d+"px"});h.css({width:d+"px"})}},windowResizeFix:function(){$.doTimeout("window-resize-fix",100,function(){UserProfile.offScreenFix()})},dateProcess:function(b,c){if(b.match(/\d\d\d\d-\d\d-\d\d[T| ]\d\d:\d\d:\d\d/)){b=b.replace(/-/g,"/").replace(/T/g," ")}else{return b}var a=new Date(Date.parse(b));fmt=c||"mmmm d, yyyy";b=a.format(fmt);return b},setLinkLineHeight:function(){var a=$(".profile ul.links li span.displayname").height();a=Math.max(a,20);$(".profile ul.links li").css("line-height",a+"px")},showHideContactBar:function(){($(".contactbar").find(".button").not(".hidden").length)?$(".contactbar").show():$(".contactbar").hide()},rgbaCheck:function(){$("body").append('<div id="rgbatest"></div>');var c="rgba(0,0,0,0.5)";var b=true;if(!$.browser.msie){try{$("#rgbatest").css("color",c);var a=$("#rgbatest").css("color");var b=/^rgba/.test(a)}catch(d){}$("div#rgba_test").remove()}UserProfile.rgbasupport=b},updateProfileColor:function(){var a=UserSettings.colors.profile_opacity;var c=UserSettings.colors.profile_color;(a<=10)?$("div.profile").addClass("profile-transparent"):$("div.profile").removeClass("profile-transparent");if(UserProfile.rgbasupport){a=a/100;if($.browser.msie&&$.browser.version<9){var d=Bevel.getHexByte(Math.floor((a)*255));$("div.profile").css("background-color","transparent").css("filter","progid:DXImageTransform.Microsoft.gradient(startColorstr=#"+d+c+",endColorstr=#"+d+c+")");$("div.profile").css("-ms-filter","progid:DXImageTransform.Microsoft.gradient(startColorstr=#"+d+c+", endColorstr=#"+d+c+")")}else{var b=Bevel.getDecimalTriplet(c);$("div.profile").css("background-color","rgba("+b+","+a+")")}Bevel.updateBevel(c)}else{if(a<=10){$("div.profile").css("background-color","transparent");$("#profile-bevel").css("visibility","hidden")}else{$("div.profile").css("background-color","#"+c);Bevel.updateBevel(c)}}}};var FaveProfile={init:function(){FaveProfile.button=$(".profile .actions .favebutton").click(FaveProfile.toggle)},toggle:function(){if(FaveProfile.button.hasClass("button-busy")){return}if(FaveProfile.button.hasClass("button-disabled")){return}FaveProfile.button.addClass("button-busy");if(FaveProfile.button.hasClass("faved")){FaveProfile.submit("remove")}else{FaveProfile.submit("add")}},submit:function(c){if(c!="add"&&c!="remove"){throw"Invalid fave action."}var a={action:c,users:JSON.stringify([UserSettings.user_name])};var b={success:function(d,e,f,g){FaveProfile.success(a,d)},error:function(d,e,f,g){FaveProfile.error(a,d)}};AboutMe.ajax.post("personal_directory",a,b);return false},success:function(b,a){FaveProfile.button.removeClass("button-busy");switch(b.action){case"add":FaveProfile.button.addClass("faved");AboutMe.banner($("div.displayname").text()+' has been added to your <a href="/dashboard/#!/favorites">Favorites</a>.');break;case"remove":FaveProfile.button.removeClass("faved");AboutMe.banner($("div.displayname").text()+' has been removed from your <a href="/dashboard/#!/favorites">Favorites</a>.');break}},error:function(b,a){FaveProfile.button.removeClass("button-busy");if(a.error==100){FaveProfile.button.addClass("faved");AboutMe.banner($("div.displayname").text()+' is already in your <a href="/dashboard/#!/favorites">Favorites</a>.',{status:"warning"})}else{if(a.error==101){FaveProfile.button.addClass("button-disabled");AboutMe.banner("You can't fave yourself.",{status:"warning"})}else{switch(b.action){case"add":AboutMe.banner("There was a problem adding "+$("div.displayname").text()+" to your Favorites. Please try again later.",{status:"error"});break;case"remove":AboutMe.banner("There was a problem removing "+$("div.displayname").text()+" from your Favorites. Please try again later.",{status:"error"});break}}}},disableMenuItem:function(){$("a#add-profile-button").unbind("click.add").closest("li").addClass("disabled")}};var FlagProfile={init:function(){$(".flagprofilelink a").on("click.flag",FlagProfile.confirm)},confirm:function(){$("#share-profile").dialog("close");AboutMe.confirm("Are you sure you want to flag this profile for abuse?",FlagProfile.flag);return false},flag:function(c){if(c!=true){return}var a={action:"flag",user:UserSettings.user_name};var b={success:function(d,e,f,g){FlagProfile.success(a,d)},error:function(d,e,f,g){FlagProfile.error(a,d)}};AboutMe.ajax.post("flag",a,b);return false},success:function(b,a){FlagProfile.disableMenuItem();AboutMe.banner("This profile has been flagged for review.")},error:function(b,a){AboutMe.banner("There was a problem flagging this profile. Please try again later.",{status:"warning"});debug(a)},disableMenuItem:function(){$("a#flag-profile-link").unbind("click.flag").closest("li").addClass("disabled")}};var AV={modal:$("#av-dialog"),disabledButton:$("#av-button-disabled"),enabledButton:$("#av-button-wrap"),nameField:$("#av-name"),emailField:$("#av-email"),launchButton:$("#av"),init:function(){AV.modal.dialog({autoOpen:false,bgiframe:true,modal:true,width:550,draggable:false,resizable:false,open:AV.open});$(".av-launch").click(function(){AV.modal.dialog("open")})},load:function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="http://x.aim.com/origin/video/10_13_2011_b/js/av-badge-simple.js";var a=document.getElementsByTagName("head")[0];a.appendChild(b);window._av=window._av||[];window._av.push(["setInviteUrlUpdatedCallback","AV.callback"])},open:function(){AV.modal.find(".alarum").hide();if(!window._av){AV.load()}AV.launchButton.click(function(){AV.modal.dialog("close")});AV.nameField.bind("keyup",AV.validate);AV.emailField.bind("keyup",AV.validate)},validate:function(){$.doTimeout("av-validate",2000,function(){AV.modal.find(".alarum").hide();var a=true;if(AV.nameField.val().length>1&&AV.emailField.val().length>1){if(!validEmail(AV.emailField.val())){AV.emailField.next(".alarum").show();a=false}if(!a){AV.enabledButton.hide();AV.disabledButton.css({display:"inline-block"});return}else{AV.enabledButton.css({display:"inline-block"});AV.disabledButton.hide();window._av.push(["setDisplayName",AV.nameField.val()])}}else{return}})},callback:function(a){$.doTimeout("send-av-email",3000,function(){if(a){AV.send(a)}})},send:function(d){debug(d);var c=UserSettings.first_name;var a={email_from:AV.emailField.val(),recipient:UserSettings.user_name,subject:AV.nameField.val()+" wants to video chat with you - About.me",plain_text:"Hi "+c+",\r\rJoin me in a quick video chat! No need to sign up, just use this link:\r\r"+d+"\r\r\rThanks!\r"+AV.nameField.val()+"\r"+AV.emailField.val()+"\r\rPS Want to start your own video chat? Details are here: http://blog.about.me/2011/11/02/announcing-av/\r\r--------------------------\rLearn about video chat safety: http://o.aolcdn.com/aim/video/10_13_2011_b/safety.html",html_text:"<p>Hi "+c+',</p><p>Join me in a quick video chat! No need to sign up, just click this link:</p><p><a href="'+d+'">'+d+"</a></p><p><br />Thanks!<br />"+AV.nameField.val()+'<br /><a href="mailto:'+AV.emailField.val()+'" style="font-size:12px">'+AV.emailField.val()+'</a></p><p>PS Want to start your own video chat? <a href="http://blog.about.me/2011/11/02/announcing-av/">Details are here</a>.</p><p>--------------------------<br /><a href="http://o.aolcdn.com/aim/video/10_13_2011_b/safety.html" style="font-size:12px">Learn about video chat safety</a></p>'};var b={success:function(g,e,f,h){debug(g);if(g.success==true){AboutMe.banner("Your video chat invite was sent!")}else{AboutMe.banner("There was a problem sending the video chat invite.",{status:"error"})}},error:function(g,e,f,h){debug(g);debug("send failed")}};AboutMe.ajax.post("send_email",a,b)}};var ServicesModal={init:function(){ServicesModal.apps.init();$("#services_modal").dialog({autoOpen:false,dialogClass:"services_modal",bgiframe:true,modal:true,height:"auto",width:580,title:$("#container_nav").html(),draggable:false,position:"top",resizable:false,closeOnEscape:true,open:function(a,b){if(window.Customize){Customize.Saver.saveNow()}var c=$(".services_modal");c.css({top:"50px",marginTop:"0px"});UserProfile.offScreenFix()},beforeClose:function(a,b){ServicesModal.apps.sendUnload()},close:function(a,b){$(".services_modal ul.tabheader li").removeClass("active");UserProfile.offScreenFix()}});$("#container_nav").remove();ServicesModal.createMoreMenu();$("body").on("typekit_loaded",function(){ServicesModal.createMoreMenu()});$("body").on("click",".services_modal ul.tabheader li a.tab, .moreservicesmenu li a.tab",function(b){AboutMe.menu.hide();var a=$(this).closest("li").attr("data-id");ServicesModal.apps.sendUnload();ServicesModal.showService(a);b.preventDefault()});$("#service-icons").on("click","li:not(.service-icon-parent) .icon",function(b){var a=$(this).closest("li").attr("data-id");ServicesModal.showService(a);$(".service-icon-parent").trigger("closeMenu");b.preventDefault()})},showService:function(b){var a="#container_"+b;var c=".tab_"+b;if(!ServicesModal.apps.XD[b]){ServicesModal.apps.build.insert(b)}$("#services_modal").dialog("open");$("#services_modal div.wrapper div.container").hide();$(".services_modal ul.tabheader li").removeClass("active");$(c).parents(".services_modal ul.tabheader li").addClass("active");$(".services_modal ul.tabheader li a").bind("click",function(){return true});$(".services_modal ul.tabheader li.active a").unbind("click",function(){return true});$(a).show(0,function(){UserProfile.offScreenFix()})},createMoreMenu:function(){var a=$(".services_modal").css("display");var b=$("ul.tabheader");$((".services_modal")).css({display:"block",marginLeft:"-9999px"});ServicesModal.removeMoreMenu();b.find("li.site a").each(function(){$(this).truncate({width:"200"})});b.find("li.site").each(function(c,d){var f=$(this).position().left+$(this).width();if(f>450){if(b.find("li.moreservicesmenu").length<1){b.find("li.site:gt("+(c-1)+")").wrapAll('<li class="menu moreservicesmenu"><div class="menu-content"><ul class="menu-items"></ul></div></li>');b.find("li.moreservicesmenu").prepend('<a href="#moreservicesmenu" class="menu-toggle">More</a>');b.find("li.moreservicesmenu .menu-content").prepend('<span class="menu-head"><a href="#moreservicesmenu" class="menu-toggle">More</a></span>');return}}});$(".services_modal").css("display",a)},removeMoreMenu:function(){$(".services_modal li.moreservicesmenu li.site").detach().appendTo(".services_modal ul.tabheader");$(".services_modal li.moreservicesmenu").remove()},codeStyle:function(a,b){$("."+a+" .code-snippet").each(function(){var d=$(this);var f=d.html();var e=f.replace(/^(.*)$/mg,"<li>$1</li>");d.html("<ol class='code'>"+e+"</ol>");var c=d.find("li");c.wrapInner("<span class='code-line' />");c.find(".code-line").truncate({width:b});texterize(c.find(".code-line"))});debug("ran codestyle")},apps:{init:function(){if(ServicesModal.apps.app_list.length){ServicesModal.apps.build.init()}},build:{init:function(){var c=ServicesModal.apps.app_list;ServicesModal.apps.app_list={};$.each(c,function(f,e){ServicesModal.apps.app_list[e.id]=e});var b=3;var d=ServicesModal.apps.app_list.length<b?ServicesModal.apps.app_list.length:b;var a=0;$.each(ServicesModal.apps.app_list,function(f,e){ServicesModal.apps.build.appsArray.push(e);a++;if(a==d){return false}});ServicesModal.apps.build.insert()},appsArray:[],appsArrayIndex:0,insert:function(b){var c=$("#services_modal .wrapper");if(b){var a=ServicesModal.apps.app_list[b]}else{var a=ServicesModal.apps.build.appsArray[ServicesModal.apps.build.appsArrayIndex];ServicesModal.apps.build.appsArrayIndex++}var e={platform:a.platform,id:a.id,url:a.iframe_url,container:a.platform+"_"+a.id,display_name:a.display_name};var d='<div class="invisible container" id="container_'+e.id+'" rel="'+e.id+'">';d+=ServicesModal.apps.extras.appNotLoadedMsg(e.display_name);d+='<div id="'+e.container+'" class="'+e.platform+' app-container"></div>';d+="</div>";c.append(d);ServicesModal.apps.load(e)}},load:function(a){debug("creating socket for "+a.platform);if(!ServicesModal.apps.XD[a.id]){ServicesModal.apps.XD[a.id]=new easyXDM.Socket({lazy:false,remote:a.url,interval:100,props:{scrolling:"no"},container:a.container,onMessage:function(c,b){ServicesModal.apps.message.incoming(c,a)},onReady:function(){if(ServicesModal.apps.build.appsArrayIndex<ServicesModal.apps.build.appsArray.length){ServicesModal.apps.build.insert()}}})}$.doTimeout("check-load-"+a.id,10000,function(){debug("app failing to load: "+a.platform);var b=$("#"+a.container).parent();b.find(".app-loading").addClass("giveup");b.find(".app-not-loaded").fadeIn(500)})},show:function(b){debug("showing "+b.platform);var a=$("#"+b.container);if($(".services_modal ul.tabheader li.site_"+b.id).hasClass("active")){a.parent().show()}a.closest(".container").find(".app-loading").hide();a.fadeIn(500)},XD:{},message:{incoming:function(b,c){var a=$.parseJSON(b);switch(a.method){case"setHeight":$("#"+c.container+" iframe").attr("height",a.params.height);UserProfile.offScreenFix();break;case"loaded":if(a.source!="error"){$.doTimeout("check-load-"+c.id);debug(c.platform+"page is loaded");ServicesModal.apps.show(c)}break;case"escapePressed":$("#services_modal").dialog("close");break;case"clickMade":AboutMe.menu.hide();break}},outgoing:function(a,b){ServicesModal.apps.XD[b.id].postMessage(a)}},app_list:{},extras:{appNotLoadedMsg:function(a){return'<div class="app-loading"><div class="app-not-loaded">We&rsquo;re not able to load the '+a+" app at this time. Please try again later.</div></div>"}},setupInternalTabs:function(){var a=$(".app .in-modal-tabbar");a.each(function(c,d){var d=$(d);var b=d.find("li");if(b.length>1){b.live("click",function(){ServicesModal.apps.internalTab($(this));return false})}else{d.hide()}})},internalTab:function(a){$(a).siblings("li").removeClass("active");$(a).addClass("active");$(a).closest(".app").find(".in-modal-tab-pane").removeClass("active");var b=$(a).attr("id").replace(/in-modal-tab_/,"");$("."+b).addClass("active")},sendUnload:function(){currentlyActive_id=$(".wrapper .container:visible").attr("rel");if(currentlyActive_id){ServicesModal.apps.message.outgoing("unload",{id:currentlyActive_id})}}}};var WindowInfo={width:function(){return window.outerWidth!=null?window.outerWidth:window.innerWidth!=null?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body!=null?document.body.clientWidth:null},height:function(){return window.outerHeight!=null?window.outerHeight:window.innerHeight!=null?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body!=null?document.body.clientHeight:null},size:function(){return[WindowInfo.width(),WindowInfo.height()]},left:function(){return window.screenX!=null?window.screenX:window.screenLeft},top:function(){return window.screenY!=null?window.screenY:window.screenTop},right:function(){return WindowInfo.left()+WindowInfo.width()},bottom:function(){return WindowInfo.top()+WindowInfo.height()},position:function(){return[WindowInfo.left(),WindowInfo.top()]},resizeFromCenter:function(c,a){var b=WindowInfo.size();var d=WindowInfo.position();window.moveTo(d[0]+((b[0]-c)/2),d[1]+((b[1]-a)/2));window.resizeTo(c,a)}};function enableDebug(a){a=a||5000;var b=AboutMe.g.JS_DEBUG;AboutMe.g.JS_DEBUG=true;setTimeout(function(){AboutMe.g.JS_DEBUG=b},a)}if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(b){if(!window.AboutMe||!AboutMe.g||!AboutMe.g.JS_DEBUG){return}if(!$("#debugwindow").length){var a=$('<div id="debugwindow"><div class="right clickable remove">x</div><p><strong>debug log</strong></p></div>');a.removable({afterRemove:function(){AboutMe.g.JS_DEBUG=false}});a.appendTo("body")}$("#debugwindow").append("<p>"+b+"</p>")}}if(!window.console.time){window.console.time=function(){debug("console.time not supported")}}if(!window.console.timeEnd){window.console.timeEnd=function(){debug("console.time not supported")}}function debug(a){if(!window.AboutMe||!AboutMe.g||!AboutMe.g.JS_DEBUG){return}console.log(a)}function handleReturnKey(b,c){if(b&&c&&$.isFunction(c)){var a=(window.Event)?b.which:b.keyCode;if(a&&a==13){c()}}}function handleEscapeKey(b,c){if(b&&c&&$.isFunction(c)){var a=(window.Event)?b.which:b.keyCode;if(a&&a==27){c()}}}function validEmail(b){if(b.length>0){var a=checkLength(b,6,254);a=a&&checkRegexp(b,/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,"eg. ui@jquery.com");return a}}function validURL(a){if(a.length>0){return checkRegexp(a,/^((http(s?))\:\/\/)?([a-zA-Z0-9])[a-zA-Z0-9\_\-\.]*\.(AC|AD|AERO|AE|AF|AG|AI|AL|AM|AN|AO|AQ|ARPA|AR|ASIA|AS|AT|AU|AW|AX|AZ|BA|BB|BD|BE|BF|BG|BH|BI|BIZ|BJ|BM|BN|BO|BR|BS|BT|BV|BW|BY|BZ|CAT|CA|CC|CD|CF|CG|CH|CI|CK|CL|CM|CN|COOP|COM|CO|CR|CU|CV|CX|CY|CZ|DE|DJ|DK|DM|DO|DZ|EC|EDU|EE|EG|ER|ES|ET|EU|FI|FJ|FK|FM|FO|FR|GA|GB|GD|GE|GF|GG|GH|GI|GL|GM|GN|GOV|GP|GQ|GR|GS|GT|GU|GW|GY|HK|HM|HN|HR|HT|HU|ID|IE|IL|IM|INFO|INT|IN|IO|IQ|IR|IS|IT|JE|JM|JOBS|JO|JP|KE|KG|KH|KI|KM|KN|KP|KR|KW|KY|KZ|LA|LB|LC|LI|LK|LR|LS|LT|LU|LV|LY|MA|MC|MD|ME|MG|MH|MIL|MK|ML|MM|MN|MOBI|MO|MP|MQ|MR|MS|MT|MUSEUM|MU|MV|MW|MX|MY|MZ|NAME|NA|NC|NET|NE|NF|NG|NI|NL|NO|NP|NR|NU|NZ|OM|ORG|PA|PE|PF|PG|PH|PK|PL|PM|PN|PRO|PR|PS|PT|PW|PY|QA|RE|RO|RS|RU|RW|SA|SB|SC|SD|SE|SG|SH|SI|SJ|SK|SL|SM|SN|SO|SR|ST|SU|SV|SY|SZ|TC|TD|TEL|TF|TG|TH|TJ|TK|TL|TM|TN|TO|TP|TRAVEL|TR|TT|TV|TW|TZ|UA|UG|UK|US|UY|UZ|VA|VC|VE|VG|VI|VN|VU|WF|WS|XN|YE|YT|YU|ZA|ZM|ZW)(\:[0-9]+)*(\/($|[a-zA-Z0-9@\(\)\.\:\,\;\?\!\'\\\+&%\$#\=~_\-]+))*$/i,"")}else{return false}}function checkRegexp(b,a){if(a.test(b)){return true}else{return false}}function checkLength(c,b,a){if(c.length>a||c.length<b){return false}else{return true}}function imposeMaxLength(b,c,a){return(c.value.length<=a)||(b.keyCode==8||b.keyCode==46||(b.keyCode>=35&&b.keyCode<=40))}function escQuotes(a){if(typeof a=="string"){return a.replace(/"/g,"&quot;").replace(/'/g,"&#39;")}else{return a}}function setSelectionRange(b,c,d){if(b.setSelectionRange){b.focus();b.setSelectionRange(c,d)}else{if(b.createTextRange){var a=b.createTextRange();a.collapse(true);a.moveEnd("character",d);a.moveStart("character",c);a.select()}}}function setCaretToPos(a,b){setSelectionRange(a,b,b)}function getQuery(a,c){var b="";a=a||"?";c=c||document.location.href;if(c.indexOf(a)>-1){b=c.substring(c.indexOf(a)+a.length,c.length)}return b}function parseQuery(f,h,c,a){var b=new Array();var g=getQuery(f,h);var c=c||"&";if(a===null){a="="}if(g){var e=g.split(c);if(a){for(i=0;i<e.length;i++){var d=e[i];b[d.split(a)[0]]=unescape(d.split(a)[1])}}else{b=e}}return b}function doubleDigit(a){if(a<10){a="0"+a}return a}function getEvent(a){a=a||window.event;return a}function getKeyCode(b){b=getEvent(b);var a=b.which||b.keyCode;return a}function getChar(b){var a=getKeyCode(b);var d=String.fromCharCode(a);return d}function dedupeArray(a){var b={};var d=[];for(var c in a){if(!b[a[c]]){b[a[c]]=true;d.push(a[c])}}return d}function texterize(b){var a=b.text();b.html(a)};